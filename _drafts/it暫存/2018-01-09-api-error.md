---
layout: post
title: '[Node.js打造API] (實作)自定義API Error拋出錯誤訊息'
categories: '2018iT邦鐵人賽'
description: ''
keywords: api
---

## 本文你將會學到
- 了解 HTTP Status Code (狀態碼)
- 使用 Node 的 http-status 組件

## 前言
[HTTP Status Code](https://developer.mozilla.org/zh-TW/docs/Web/HTTP/Status) 又稱為狀態碼，相信各位一定不陌生，相信各位對 404 有的別深的印象，而它代表找不到網頁或失去連結，狀態碼真的那麼重要嗎？他能夠做什麼？這篇文章就是要帶你了解所有常見的狀態碼，與他真正的使用的時機。


## 何謂 HTTP Status Code？
HTTP 狀態碼指的是從伺服器端回應(HTTP Response)的狀態，主要是給開發者看的狀態碼，而所有狀態碼的第一個數字代表了五種狀態之一，最基本常見會用到 200 成功、304 未修改、400 客戶端參數錯誤、401 登入失敗、403 權限不夠、404 找無此資源、500 伺服器錯誤。

- 1xx 資訊回應
- 2xx 成功回應
- 3xx 重定向訊息
- 4xx 用戶端錯誤回應
- 5xx 伺服器錯誤回應


<img src="http://faq.biznetgiocloud.com/images/1_4.png" width="650">

[圖片來源](http://faq.biznetgiocloud.com/index.php?action=artikel&cat=1&id=240&artlang=en)

## 如何在 Node.js 中加狀態碼？
其實很簡單直接在標頭加個 `status()` 的函示裡面寫上相對應的狀態碼即可，你可以簡單寫一個 GET 的 Request 到 Postman 做測試，可以發現紅色框框處即是我們剛所設定的狀態，若你沒指定狀態系統會自動幫你補上狀態像是 200 或 500，若要更詳細的錯誤碼就必須要自己定義加上去了。

#### 方法一 
第一種方式直接填上相對應數字。

```js
app.get('/', (req, res) => {
  res.status(202).send(`歡迎光臨`);
});
```

<img src="/images/posts/it2018/img1070110-1.png">


#### 方法二 
第一種方法雖然簡單，但常常為了要找出相對應的狀態碼而去網路查詢它對應的敘述太麻煩了，所以這邊建議使用 Node.js 的 http-status 組件來管理狀態碼。

##### 1. 安裝 http-status
安裝 Node.js 的 http-status 組件

```bash
yarn add http-status
```

##### 2. 使用方法

```js
app.get('/', (req, res) => {
  res.status(httpStatus.BAD_GATEWAY).send(`進入 502 Bad Gateway`);
});
```

<img src="/images/posts/it2018/img1070110-2.png">
